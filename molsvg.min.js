!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.molsvg=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d={H:"#000000",He:"#FFC0CB",Li:"#B22222",B:"#00FF00",C:"#000000",N:"#8F8FFF",O:"#F00000",F:"#DAA520",Na:"#0000FF",Mg:"#228B22",Al:"#808090",Si:"#DAA520",P:"#FFA500",S:"#FFC832",Cl:"#00FF00",Ca:"#808090",Ti:"#808090",Cr:"#808090",Mn:"#808090",Fe:"#FFA500",Ni:"#A52A2A",Cu:"#A52A2A",Zn:"#A52A2A",Br:"#A52A2A",Ag:"#808090",I:"#A020F0",Ba:"#FFA500",Au:"#DAA520"};b.exports=function(){function a(a){i=d3.rgb(d[f.symbol[0]]);var m=a.append("svg:g").attr("class","atom atom-"+f.symbol).attr("transform","translate("+k(f.x)+","+l(f.y)+")");if(g?b(m):(c(m),h||e(m)),0!==f.charge){var n=f.charge;n=n<0?n===-1?"-":n+"-":1===n?"+":n+"+",m.append("text").attr("dx",1*Math.ceil(j/3)).attr("dy",-1*Math.ceil(j/4.5)).attr("text-anchor","left").attr("font-family","sans-serif").attr("fill",i).attr("font-size",Math.ceil(j/3)).text(n)}return 0!==f.mass&&m.append("text").attr("dx",-2*Math.ceil(j/3)).attr("dy",-1*Math.ceil(j/4.5)).attr("text-anchor","left").attr("font-family","sans-serif").attr("font-size",Math.ceil(j/3)).attr("fill",i).text(f.mass),m}function b(a){var b=Math.ceil(j/6),c=a.append("svg:circle").attr("r",b).attr("x",-b/2).attr("y",-b/2).attr("fill",i).attr("opacity","1");return c}function c(a){var b=Math.ceil(j/3),c=a.append("svg:ellipse").attr("rx",b*f.symbol.length).attr("ry",b).attr("fill","white").attr("opacity","1");return c}function e(a){var b=a.append("text").attr("dy",Math.ceil(j/4.5)).attr("text-anchor","middle").attr("font-family","sans-serif").attr("font-size",Math.ceil(j/1.5)).attr("fill",i).text(f.symbol);return b}var f,g,h,i,j,k,l;return a.atom=function(b){return arguments.length?(f=b,a):f},a.bondLength=function(b){return arguments.length?(j=b,a):j},a.noSymbols=function(b){return arguments.length?(g=b,a):g},a.hidden=function(b){return arguments.length?(show_placeholder=b,a):show_placeholder},a.x=function(b){return arguments.length?(k=b,a):k},a.y=function(b){return arguments.length?(l=b,a):l},a}},{}],2:[function(a,b,c){var d=function(a,b,c,d){return Math.sqrt((c-a)*(c-a)+(d-b)*(d-b))};b.exports=function(){function a(a){var b=k[j.a1],p=k[j.a2],q=m?0:.2,r=p.x-b.x,s=p.y-b.y,t=Math.sqrt(r*r+s*s),u=r/t*q,v=s/t*q,w=b.x+u,x=b.y+v,y=p.x-u,z=p.y-v;l=d(n(w),o(x),n(y),o(z)),1===j.order?1===j.stereo?e(a,w,y,x,z,t):6===j.stereo?f(a,w,y,x,z,t):4===j.stereo?g(a,w,y,x,z,t):c(a,w,y,x,z,t):2===j.order?h(a,w,y,x,z,t):3===j.order&&i(a,w,y,x,z,t)}function b(a,b){a.append("svg:path").attr("d",p(b)).attr("stroke-width","1").attr("stroke-linecap","round").attr("stroke-linejoin","round").attr("stroke","black")}function c(a,c,d,e,f){xyData=[[c,e],[d,f]],b(a,xyData)}function e(a,b,c,e,f){var g,h,i,j=[],k=d(b,e,c,f);g=.1,h=g*(f-e)/k,i=g*(b-c)/k,j=[[b,e],[c+h,f+i],[c-h,f-i]],a.append("svg:path").style("fill","black").style("stroke-width",1).attr("d",q(j))}function f(a,b,c,d,e,f){console.log("hash",b,c,d,e,f);var g,h,i,j=[];g=.15,h=g*(e-d)/f,i=g*(b-c)/f;for(var k=c+h-b,l=e+i-d,m=c-h-b,n=e-i-d,o=.05;o<=1;o+=.15)j.push([b+k*o,d+l*o],[b+m*o,d+n*o]);console.log("hashxy",j.map(function(a){return a[0]})),a.append("svg:path").style("fill","none").style("stroke-width",1).attr("d",r(j)).attr("stroke","black")}function g(a,b,c,d,e,f){var g,h,i,j=[];g=.2,h=g*(e-d)/f,i=g*(b-c)/f;for(var k=c+h-b,l=e+i-d,m=c-h-b,n=e-i-d,o=.05;o<=1;o+=.1)j.length%2===0?j.push([b+k*o,d+l*o]):j.push([b+m*o,d+n*o]);a.append("svg:path").attr("d",s(j)).attr("fill","none").style("stroke-width",1).attr("stroke","black")}function h(a,c,d,e,f,g){var h,i,j,k=[];h=.1,i=h*(f-e)/g,j=h*(c-d)/g,k=[[c+i,e+j],[d+i,f+j],[c-i,e-j],[d-i,f-j]],b(a,k)}function i(a,c,d,e,f,g){var h,i,j,k=[];h=.15,i=h*(f-e)/g,j=h*(c-d)/g,k=[[c,e],[d,f],[c+i,e+j],[d+i,f+j],[c-i,e-j],[d-i,f-j]],b(a,k)}var j,k,l,m,n,o;a.bond=function(b){return arguments.length?(j=b,a):j},a.atoms=function(b){return arguments.length?(k=b,a):k},a.noSymbols=function(b){return arguments.length?(m=b,a):m},a.x=function(b){return arguments.length?(n=b,a):n},a.y=function(b){return arguments.length?(o=b,a):o};var p=d3.svg.line().interpolate(function(a){for(var b=a[0][0]+","+a[0][1],c=1;c<a.length;c++)b+=c%2===0?"M"+a[c][0]+","+a[c][1]:"L"+a[c][0]+","+a[c][1];return b}).x(function(a){return n(a[0])}).y(function(a){return o(a[1])}),q=d3.svg.line().x(function(a){return n(a[0])}).y(function(a){return o(a[1])}),r=d3.svg.line().interpolate(function(a){for(var b=a[0][0]+","+a[0][1],c=1;c<a.length;c++)b+=c%2===0?"M"+a[c][0]+","+a[c][1]:"L"+a[c][0]+","+a[c][1];return b}).x(function(a){return n(a[0])}).y(function(a){return o(a[1])}),s=d3.svg.line().interpolate("cardinal").x(function(a){return n(a[0])}).y(function(a){return o(a[1])});return a}},{}],3:[function(a,b,c){b.exports=function(){function a(a){var i=d3.extent(b,function(a){return a.x}),j=d3.extent(b,function(a){return a.y}),k=f?[0,0,0,0]:[20,20,20,20],l=g-k[1]-k[3],m=h-k[0]-k[2],n=(i[1]-i[0])/(j[1]-j[0]);return n>1?m/=n:l*=n,c=d3.scale.linear().domain([i[0],i[1]]).range([0,l]),d=d3.scale.linear().domain([j[0],j[1]]).range([m,0]),e=a.append("svg:svg").attr("width",l+k[1]+k[3]).attr("height",m+k[0]+k[2]).append("svg:g").attr("transform","translate("+k[3]+","+k[0]+")")}var b,c,d,e,f,g=200,h=200;return a.atoms=function(c){return arguments.length?(b=c,a):b},a.width=function(b){return arguments.length?(g=b,a):g},a.height=function(b){return arguments.length?(h=b,a):h},a.noMargins=function(b){return f=b,a},a.x=function(){return c},a.y=function(){return d},a.el=function(){return e},a}},{}],4:[function(a,b,c){b.exports=function(){function b(b){void 0===c&&console.error("No Mol file provided."),parsed_mol=a("./parser")(c);var l=parsed_mol[0],m=parsed_mol[1];b.call(i.atoms(l)),d=i.x(),e=i.y(),k=k.atoms(l).x(d).y(e),console.log("implicit",g),m.filter(function(a){return h.indexOf(l[a.a1].symbol)<0&&h.indexOf(l[a.a2].symbol)<0}).forEach(function(a){i.el().call(k.bond(a))}),f&&h.push("C"),j=j.bondLength(21).x(d).y(e),l.filter(function(a){return h.indexOf(a.symbol)<0}).forEach(function(a){i.el().call(j.atom(a))}),console.log("rendered")}var c,d,e,f,g,h=[],i=a("./graph")(),j=a("./atom")(),k=a("./bond")();return b.molfile=function(a){return arguments.length?(c=a,b):c},b.implicitH=function(a){return arguments.length?(a?h.push("H"):h=h.filter(function(a){return"H"!==a}),g=a,b):g},b.noSymbols=function(a){return arguments.length?(j=j.noSymbols(a),k=k.noSymbols(a),b):j.noSymbols()},b.organic=function(a){return arguments.length?(a&&(j=j.noSymbols(a),k=k.noSymbols(a),b.implicitH(a)),f=a,b):f},b.width=i.width,b.height=i.height,b}},{"./atom":1,"./bond":2,"./graph":3,"./parser":5}],5:[function(a,b,c){var d=function(a,b){for(var c=[],d=4,e=d;e<b+d;e++){var f=a[e].match(/-*\d+\.\d+|\w+/g);c.push({x:parseFloat(f[0]),y:parseFloat(f[1]),symbol:f[3],mass:0,charge:0})}return c},e=function(a,b,c){for(var d=[],e=4,f=b+e;f<b+c+e;f++){var g=a[f].match(/\d+/g);d.push({a1:parseInt(g[0])-1,a2:parseInt(g[1])-1,order:parseInt(g[2]),stereo:parseInt(g[3])})}return d},f=function(a,b,c){var d,e,f,g,h=4;for(d=c+h;d<a.length;d++)if(a[d].indexOf("M  ISO")!==-1)for(g=a[d].match(/-*\d+/g),e=0,f=1;e<g[0];e++,f+=2)b[g[f]-1].mass=parseInt(g[f+1],10);else if(a[d].indexOf("M  CHG")!==-1)for(g=a[d].match(/-*\d+/g),e=0,f=1;e<g[0];e++,f+=2)b[g[f]-1].charge=parseInt(g[f+1],10)};b.exports=function(a){var b=a.split(/\r\n|\n/),c=b[3].match(/\d+/g),g=parseFloat(c[0]),h=parseFloat(c[1]),i=d(b,g),j=e(b,g,h);return f(b,i,g+h),[i,j]}},{}]},{},[4])(4)});